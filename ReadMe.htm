<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:.25in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:20.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#538135;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#538135;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#538135;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:normal;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:normal;
	font-style:italic;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:bold;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:120%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-style:italic;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;
	font-variant:small-caps;
	color:#595959;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:48.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#262626;
	letter-spacing:-.75pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:48.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#262626;
	letter-spacing:-.75pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:48.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#262626;
	letter-spacing:-.75pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:48.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#262626;
	letter-spacing:-.75pt;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"Subtitle Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:15.0pt;
	font-family:"Calibri Light",sans-serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
em
	{color:#70AD47;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-link:"Quote Char";
	margin-top:8.0pt;
	margin-right:.5in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	text-align:center;
	line-height:120%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;
	color:#262626;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"Intense Quote Char";
	margin-top:8.0pt;
	margin-right:.5in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	text-align:center;
	line-height:110%;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-style:italic;}
span.MsoSubtleEmphasis
	{font-style:italic;}
span.MsoIntenseEmphasis
	{font-weight:bold;
	font-style:italic;}
span.MsoSubtleReference
	{font-variant:small-caps;
	color:#595959;}
span.MsoIntenseReference
	{font-variant:small-caps;
	color:#70AD47;
	font-weight:bold;}
span.MsoBookTitle
	{font-variant:small-caps;
	text-transform:none;
	letter-spacing:.35pt;
	font-weight:bold;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:20.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#538135;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	color:#538135;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri Light",sans-serif;
	color:#538135;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#538135;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-style:italic;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:bold;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-weight:bold;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-style:italic;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	color:#262626;
	letter-spacing:-.75pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-link:Subtitle;
	font-family:"Calibri Light",sans-serif;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-link:Quote;
	color:#262626;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-link:"Intense Quote";
	font-family:"Calibri Light",sans-serif;
	color:#70AD47;
	font-style:italic;}
.MsoChpDefault
	{font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:120%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<h1>Using FireMonkey to send an email with an attachment </h1>

<p class=MsoNormal>I’ve decided to start posting solutions to technologies
using Delphi and in particular FireMonkey with this blog. Today, I am going to
share how to send emails with attachments with FireMonkey for iOS devices.</p>

<h2>Sending simple email (No attachment)</h2>

<p class=MsoNormal>It is pretty straightforward to send an email without an
attachment in FireMonkey. The syntax for this is as follows. In your uses
section, you will need to add some ios units.</p>

<p class=MsoNoSpacing>Uses</p>

<p class=MsoNoSpacing>  Macapi.ObjectiveC,</p>

<p class=MsoNoSpacing>  Macapi.Helpers,</p>

<p class=MsoNoSpacing>  FMX.Helpers.iOS,</p>

<p class=MsoNoSpacing>  iOSapi.Foundation;</p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:120%;font-family:
"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>Then define the following procedure to email</p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>procedure
Email(Recipient, Subject, Content: string);</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>var</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
lURL: string;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
nsURL: NSString;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>begin</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'> 
lURL := 'mailto:'+Recipient;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'> 
if (Subject&lt;&gt;'') or (Content&lt;&gt;'') then</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'> 
begin</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
lURL := lURL+'?subject='+Subject;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
if Content&lt;&gt;'' then</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>     
lURL := lURL+'&amp;body='+ Content;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
nsURL:=
StrToNSStr(lURL).stringByAddingPercentEscapesUsingEncoding(NSASCIIStringEncoding);</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>   
lURL:= NSStrToStr(nsURL);</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'> 
end;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'> 
SharedApplication.openURL(StrToNSUrl(lURL));</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>end;</span></p>

<p class=MsoNoSpacing><span style='font-size:8.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>Now emailing is as simple as</p>

<p class=MsoNormal>  <span style='font-size:9.0pt;line-height:120%;font-family:
"Courier New"'>Email('roywoll@gmail.com', 'subject', 'content');</span></p>

<h2>Sending Email (with Attachment)</h2>

<p class=MsoNormal>Now unfortunately, this technique cannot email an
attachment. But there is a way to do this in RAD Studio. Since its tricky
coding, we have created a simple routine that you can call. We have provided all
the code and you can download this at</p>

<p class=MsoNormal><a
href="https://github.com/roywoll/wwEmailWithAttachment_fmx">https://github.com/roywoll/wwEmailWithAttachment_fmx</a></p>

<p class=MsoNormal style='margin-bottom:8.0pt'>This project contains a unit
named wwEmailWithAttachment.pas which defines the method</p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>procedure
wwEmail(</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>   Recipients:
Array of String;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>   ccRecipients:
Array of String;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>   bccRecipients:
Array of String;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>   Subject,
Content,</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>  
AttachmentPath: string;</span></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>   mimeTypeStr:
string = ''); overload;</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:120%;font-family:
"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>To use this method, add the unit wwEmailWithAttachment to
your form’s uses clause, and then call the procedure as in the following:</p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;font-family:"Courier New"'> 
wwEmail(['roywoll@gmail.com', 'royswoll@yahoo.com'],</span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;font-family:"Courier New"'>   
[], [], 'Subject', 'Content', fileName);</span></p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:120%;font-family:
"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal>There is one more step required. The unit wwEmailWithAttachment
uses the part of the iOS SDK that FireMonkey has not put into the default
library. So when you compile and link your code, you will receive a link error.
Fortunately, its straightforward to add this part of the sdk to your
environment. Once you have this done, then you won’t have to do it again. The
steps are detailed below.</p>

<p class=MsoNormal style='line-height:15.0pt'><span style='color:#24292E'>You
wll need to add the MessageUI framework to your iOS sdk in the RAD Studio IDE. </span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.25in;text-indent:-.25in;
line-height:15.0pt'><span style='color:#24292E'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Select from the
IDE - Tools | Options | SDK Manager</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
line-height:15.0pt'><span style='color:#24292E'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Then for your 64
bit platform (and 32 bit if you like) do the following</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:15.0pt'><span
style='color:#24292E'>a)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Scroll to the
bottom of your Frameworks list and select the last one</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:15.0pt'><span
style='color:#24292E'>b)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Click the add
button on the right to add a new library refence and</span></p>

<p class=MsoNormal style='line-height:15.0pt'><span style='color:#24292E'>     
then enter the following data for your entry</span></p>

<p class=MsoNoSpacing style='margin-left:.5in'><b>Path on remote machine</b>:  $(SDKROOT)/System/Library/Frameworks</p>

<p class=MsoNoSpacing style='margin-left:.5in'><b>File Mask: </b>MessageUI</p>

<p class=MsoNoSpacing style='margin-left:.5in'><b>Path Type: </b>Leave
unselected</p>

<p class=MsoNoSpacing style='margin-left:.5in'><b>&nbsp;</b></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.25in;text-indent:-.25in;
line-height:15.0pt'><span style='color:#24292E'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Click the button
<i>Update Local File Cache</i> to update your sdk</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.25in;text-indent:-.25in;
line-height:15.0pt'><span style='color:#24292E'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span dir=LTR></span><span style='color:#24292E'>Click the OK
Button to close the dialog</span></p>

<p class=MsoNormal>One you have done this, you can compile the project and it
should yield no linker errors.</p>

<h1>Android</h1>

<p class=MsoNormal><span style='font-family:"Times New Roman",serif'>If you
wish to do this same thing with Android, its much simpler.  The provided unit
also contains the same method for Android, so you can email with the same exact
code in your project. In addition, you don’t need to update your SDK, as it
will work without any changes to your environment.</span></p>

</div>

</body>

</html>
